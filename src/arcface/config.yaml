general:
  seed: 42
  wandb: false
  num_classes: 135
  emb_dim: 512

wandb:
  project: arcface
  name: efficientnet
  tags: ['efficientnet', 'arcface']
  credentials: "wandb.env" # intialize credentials in this file
  registry:
  - name: "face"

model:
  type: efficientnet
  pretrained: true
  efficientnet:
    input_size: 112
    backbone_path: /workspace/SurveillanceAI/src/arcface/models/efficientnet
    pretrained: false
    lr : 0.0003
  

loss:
  type: arcface
  arcface:
    s: 64.0  # scale
    m: 0.5   # margin
    easy_margin: false
    sample_rate: 0.1

data:
  path: /workspace/SurveillanceAI/src/arcface/data/faces
  input_size: 112
  use_dali: false # need to be done
  train_val_split: 0.85
  dataloader:
    batch_size: 32
    num_workers: 4

train:
  callbacks:
    early_stopping:
      patience: 10
      monitor: val_loss
      mode: min
    model_checkpoint:
      monitor: val_loss
      mode: min
      save_top_k: 1
      save_weights_only: true
      filename: '{epoch:02d}-{val_loss:.2f}'
  args:
    accelerator: gpu
    strategy: auto
    fast_dev_run: false
    check_val_every_n_epoch: 1
    num_sanity_val_steps: 10
    enable_progress_bar: true
    default_root_dir: /workspace/SurveillanceAI/src/arcface/models/efficientnet
    max_epochs: 10
    min_epochs: 2
    precision: 16
    gradient_clip_val: 1.0
    accumulate_grad_batches: 1
    gradient_clip_algorithm: norm

train_pipeline:
  optimization: true
  post_training: true
  push_registry: true
  device: cuda
  model_path: /workspace/SurveillanceAI/src/arcface/models/efficientnet/arface.pt
  payload_map: /workspace/SurveillanceAI/src/arcface/data/label_map.csv

optimization:
  tensorrt: true
  onnx: true
  prune: true
  quantization: false

inference_pipeline:
  ckpt_path: fill # 
  device: cuda

vector-db:
  db: "qdrant"
  dim: 512
  collection_name: "faces"
  credentials: "vectordb.env" # intialize credentials in this file
  quantization: "int8" # supported = ['int8']
